---
# defaults file for kn-cis-pg-15
#

pg15cis_section_1: true
pg15cis_section_2: true
pg15cis_section_3: true
pg15cis_section_4: true
pg15cis_section_6: true
pg15cis_section_7: true
pg15cis_section_8: true

# Section 1, Installation and Patches
pg15cis_rule_1_2: true
pg15cis_rule_1_3: true

#
# Section 2, Directory and File Permissions
pg15cis_rule_2_1: true

# Section 3, Logging and Auditing
pg15cis_rule_3_1_2: true
pg15cis_rule_3_1_3: true
pg15cis_rule_3_1_4: true
pg15cis_rule_3_1_5: true
pg15cis_rule_3_1_6: true
pg15cis_rule_3_1_7: true
pg15cis_rule_3_1_8: true
pg15cis_rule_3_1_9: true
pg15cis_rule_3_1_11: true
pg15cis_rule_3_1_12: true
pg15cis_rule_3_1_13: true
pg15cis_rule_3_1_14: true
pg15cis_rule_3_1_15: true
pg15cis_rule_3_1_16: true
pg15cis_rule_3_1_17: true
pg15cis_rule_3_1_18: true
pg15cis_rule_3_1_19: true
pg15cis_rule_3_1_20: true
pg15cis_rule_3_1_21: true
pg15cis_rule_3_1_22: true
pg15cis_rule_3_1_23: true
pg15cis_rule_3_1_24: true
pg15cis_rule_3_1_25: true
pg15cis_rule_3_1_26: true
pg15cis_rule_3_2: true

# Section 4
# User Access and Authorization
pg15cis_rule_4_3: true
pg15cis_rule_4_6: true

# Section 6
# PostgreSQL Settings
pg15cis_rule_6_2: true
pg15cis_rule_6_7: true
pg15cis_rule_6_8: true

# Section 7
# Replication
pg15cis_rule_7_4: true

# Section 8

# Special Configuration Considerations
pg15cis_rule_8_2: true

###########
# Role vars - Global

# The configured postgres system user
pg15cis_postgres_user: postgres
pg15cis_postgres_group: postgres

# The location of the postgresql.config file, is gathered from a prelim task by default
pg15cis_config_file: "{{ pg15cis_config_file_get.stdout }}"

###########
# Section 1
# 1.2

# The variable for the name of the PostgreSQL service, is gathered from a prelim task by default
pg15cis_postgresql_service: "{{ pg15cis_postgresql_service_default }}"

###########
# Section 2
# 2.1

# Value for the PostgreSQL user umask settings, must be 0077 or more restrictive
pg15cis_umask_value: "077"

# Flag value indicating ansible won't create profile environment file unless none exists
pg15cis_2_1_env_file_found: False


# PostgreSQL home directory, this is gathered from a prelim task
pg15cis_pg15_usr_home_dir: "{{ pg15cis_pg15_usr_home_dir_get.stdout }}"

###########
# Section 3
# 3.1.2
# PostgreSQL supports several methods for logging server messages, including stderr, csvlog and syslog
pg15cis_log_destination: syslog

# 3.1.7
# Ensure 'log_truncate_on_rotation' is enabled
pg15cis_postgres_log_truncate_on_rotation: 'on'

# 3.2
# pg15cis_shared_preload_libraries are the shared pre-load libraries
# The value for this variable must list pgaudit, but can have more items and will be comma separated list with no space between items
# Example for multiple items pg15cis_shared_preload_libraries: pgaudit,somethingelse
pg15cis_shared_preload_libraries: pgaudit

# pg15cis_pgaudit_log_types are the pgaudit log types that will be logged
# The options are READ, WRITE, FUNCTION, ROLE, DDL, and MISC. You can also have multiple types listed and separated by a comma with no spaces
# Example pg15cis_pgaudit_log_types: ddl,write
pg15cis_pgaudit_log_types: ddl,write


